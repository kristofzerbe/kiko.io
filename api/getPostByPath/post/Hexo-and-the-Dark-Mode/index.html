{"type":"getPostByPath","data":{"title":"Hexo and the Dark Mode","date":"2019-10-23T13:28:04.000Z","description":"<p>Due to the fact, that nowadays everybody is talking about Dark Modes for Browsers and Operating Systems, in order to save battery or for easier reading (uhh, really?), I decided my blog should support that.</p>\n<p><img src=\"/post/Hexo-and-the-Dark-Mode/screen-recording-1.gif\" alt=\"Switching Dark Mode in Windows 10\"></p>","categories":[{"name":"Tools","_id":"clnbzomem003tk4ofho0m7oqk"}],"tags":[{"name":"Hexo","_id":"clnbzomej003ok4of72mvbdx7"},{"name":"CSS","_id":"clnbzomek003qk4of9ty526x9"},{"name":"Stylus","_id":"clnbzomf3004qk4ofapkp2rh5"},{"name":"Dark Mode","_id":"clnbzomf4004sk4of77r67lmo"}],"content":"<p>Due to the fact, that nowadays everybody is talking about Dark Modes for Browsers and Operating Systems, in order to save battery or for easier reading (uhh, really?), I decided my blog should support that.</p>\n<p><img src=\"/post/Hexo-and-the-Dark-Mode/screen-recording-1.gif\" alt=\"Switching Dark Mode in Windows 10\"></p>\n<span id=\"more\"></span>\n\n<p>Starting point is the new media query <code>prefers-color-scheme</code>, which is actually supported by all modern browsers.</p>\n<h2 id=\"Technique\"><a href=\"#Technique\" class=\"headerlink\" title=\"Technique\"></a>Technique</h2><p>My first read was Tom Brow’s <a href=\"https://tombrow.com/dark-mode-website-css\">Dark mode in a website with CSS</a>, where he shows how to use the media query. Simplified, this is it, assuming the light version is the default:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">body</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: white;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@media</span> (<span class=\"attribute\">prefers-color-scheme</span>: dark) &#123;</span><br><span class=\"line\">  <span class=\"selector-tag\">body</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: black;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Pimping-CSS-for-automatic-switching\"><a href=\"#Pimping-CSS-for-automatic-switching\" class=\"headerlink\" title=\"Pimping CSS for automatic switching\"></a>Pimping CSS for automatic switching</h2><p>To support the automatic browser&#x2F;OS-based automatic switch in Hexo, where <a href=\"http://stylus-lang.com/\">Stylus</a> is used, I had to change some template files. First the <code>_variables.styl</code>:</p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// existing color variables</span></span><br><span class=\"line\"><span class=\"attribute\">color</span>-background = <span class=\"number\">#f1f1f1</span></span><br><span class=\"line\"><span class=\"attribute\">color</span>-foreground = <span class=\"number\">#111</span></span><br><span class=\"line\"><span class=\"attribute\">color</span>-border = <span class=\"number\">#ddd</span></span><br><span class=\"line\">...</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// new dark color variables</span></span><br><span class=\"line\">dark-<span class=\"attribute\">color</span>-background = <span class=\"number\">#111</span></span><br><span class=\"line\">dark-<span class=\"attribute\">color</span>-foreground = <span class=\"number\">#eee</span></span><br><span class=\"line\">dark-<span class=\"attribute\">color</span>-border = <span class=\"number\">#000</span></span><br><span class=\"line\">...</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// new media query variable</span></span><br><span class=\"line\">prefers-dark = <span class=\"string\">&quot;(prefers-color-scheme: dark)&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>Next step was to change the <code>_extend.styl</code>, where some Stylus variables are defining complete blocks to extend. Here I had to supplement all lines, where something mode-dependend was defined, by adding the new <code>prefers-dark</code> media query and beneath the new ‘dark’ equivalence of the style:</p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$base</span>-style</span><br><span class=\"line\">  hr</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> dashed color-border-article</span><br><span class=\"line\">    <span class=\"keyword\">@media</span> prefers-dark</span><br><span class=\"line\">      border: <span class=\"number\">1px</span> dashed dark-color-border-article</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">$block</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  background: color-block</span><br><span class=\"line\">  box-shadow: <span class=\"number\">1px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> color-border</span><br><span class=\"line\">  border: <span class=\"number\">1px</span> solid color-border</span><br><span class=\"line\">  @media prefers-dark</span><br><span class=\"line\">    background: dark-color-block</span><br><span class=\"line\">    box-shadow: <span class=\"number\">1px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> dark-color-border</span><br><span class=\"line\">    border-color: dark-color-border</span><br><span class=\"line\"></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<p>The same changes I had to do in every template <code>styl</code> file, where one of the colors or other mode dependent style was used. For example:</p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#mobile-nav-header</span></span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: color-background</span><br><span class=\"line\">  <span class=\"keyword\">@media</span> prefers-dark</span><br><span class=\"line\">    background-color: dark-color-background</span><br><span class=\"line\">  img.avatar</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    @media prefers-dark</span><br><span class=\"line\">      filter: brightness(<span class=\"number\">85%</span>)</span><br></pre></td></tr></table></figure>\n\n<p>This will be rendered as:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#mobile-nav-header</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#f1f1f1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@media</span> (<span class=\"attribute\">prefers-color-scheme</span>: dark) &#123;</span><br><span class=\"line\">    <span class=\"selector-id\">#mobile-nav-header</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"number\">#111</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#mobile-nav-header</span> <span class=\"selector-tag\">img</span><span class=\"selector-class\">.avatar</span> &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@media</span> (<span class=\"attribute\">prefers-color-scheme</span>: dark) &#123;</span><br><span class=\"line\">  <span class=\"attribute\">filter</span>: <span class=\"built_in\">brightness</span>(<span class=\"number\">85%</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Please note the use of <code>filter:brightness()</code> in the example. It is always advisable to darken the images too, because they can really pop out on dark backgrounds.</p>\n","_path":"post/Hexo-and-the-Dark-Mode/","_link":"https://kiko.io/post/Hexo-and-the-Dark-Mode/","_id":"clnbzomao000ek4ofbb8h9k4y"}}