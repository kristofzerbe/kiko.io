{"type":"getPostByPath","data":{"title":"Generate Content from Trello","date":"2022-12-29T11:08:00.000Z","description":"<p>I’m collecting&#x2F;bookmarking links to interesting website post on a public Trello board and aggregating them from time to time in a special post series called <em>Discoveries</em>, where I present 10 of them in one post on a specific topic.</p>\n<p>Writing these summaries is currently still a bit time-consuming, because in addition to the link, the name of the author and a small description, I would also like to display a screenshot of the page in each case … and it is still a completely manual process.</p>\n<p>After selecting the 10 links I want to talk about, I first create a new post for my Hexo blog and then process the links as follows:</p>\n<ol>\n<li>Creating, resizing and saving the screenshot</li>\n<li>Creating a new section in the post</li>\n<li>Setting a key for the post based on the title</li>\n<li>Setting the title</li>\n<li>Setting the author</li>\n<li>Setting the screenshot file</li>\n</ol>\n<p>I do use two tag plugins (<a href=\"https://github.com/kristofzerbe/kiko.io/blob/2c80a548e188c05879039a15e67419b548bfbfcd/themes/landscape/scripts/tag-anchorlist.js\">tag-anchorlist</a> and <a href=\"https://github.com/kristofzerbe/kiko.io/blob/2c80a548e188c05879039a15e67419b548bfbfcd/themes/landscape/scripts/tag-discovery.js\">tag-discovery</a>) for this in the post draft, but despite that, it’s quite time-consuming and always the same procedure that can be wonderfully automated… and here I’d like to write about how I approached this task, while I’m working on it.</p>","categories":[{"name":"JavaScript","_id":"cllqc0542003nkjq058hib42z"}],"tags":[{"name":"Hexo","_id":"cllqc053z003gkjq0ek586o0t"},{"name":"Trello","_id":"cllqc054j0052kjq0ecegfj5s"},{"name":"Publishing","_id":"cllqc054t0063kjq0c6j2cnsa"}],"content":"<p>I’m collecting&#x2F;bookmarking links to interesting website post on a public Trello board and aggregating them from time to time in a special post series called <em>Discoveries</em>, where I present 10 of them in one post on a specific topic.</p>\n<p>Writing these summaries is currently still a bit time-consuming, because in addition to the link, the name of the author and a small description, I would also like to display a screenshot of the page in each case … and it is still a completely manual process.</p>\n<p>After selecting the 10 links I want to talk about, I first create a new post for my Hexo blog and then process the links as follows:</p>\n<ol>\n<li>Creating, resizing and saving the screenshot</li>\n<li>Creating a new section in the post</li>\n<li>Setting a key for the post based on the title</li>\n<li>Setting the title</li>\n<li>Setting the author</li>\n<li>Setting the screenshot file</li>\n</ol>\n<p>I do use two tag plugins (<a href=\"https://github.com/kristofzerbe/kiko.io/blob/2c80a548e188c05879039a15e67419b548bfbfcd/themes/landscape/scripts/tag-anchorlist.js\">tag-anchorlist</a> and <a href=\"https://github.com/kristofzerbe/kiko.io/blob/2c80a548e188c05879039a15e67419b548bfbfcd/themes/landscape/scripts/tag-discovery.js\">tag-discovery</a>) for this in the post draft, but despite that, it’s quite time-consuming and always the same procedure that can be wonderfully automated… and here I’d like to write about how I approached this task, while I’m working on it.</p>\n<span id=\"more\"></span>\n\n<hr>\n<h2 id=\"The-Trello-List\"><a href=\"#The-Trello-List\" class=\"headerlink\" title=\"The Trello List\"></a>The Trello List</h2><p>How easy it is to save a link as a card in a Trello board via Chrome, I described recently in my post <a href=\"/post/Add-website-to-Trello-card-the-better-way/\" title=\"Add website to Trello card the better way\">Add website to Trello card the better way</a>. As this works also in Chrome on Android, I store interesting links on the go mostly. In order to get all information I need later on, I have extended my collections board with a custom field called ‘Author’. For adding the screenshot to the card as an attachment, I use actually the build-in feature of Android 6.</p>\n<p>As I have a long, long list if incoming links, I sort them by topic into an appropriate list, for example, “Discoveries: JS Libraries” and this lists should then be automatically turned into new blog posts as I want to publish one.</p>\n<p><img src=\"/post/Generate-Content-from-Trello/trello-test-board.png\" alt=\"Trello Test Board\"></p>\n<hr>\n<h2 id=\"The-Data\"><a href=\"#The-Data\" class=\"headerlink\" title=\"The Data\"></a>The Data</h2><p>Now, to get the raw data of a Trello list, I could use to the Atlassian API, but that’s not even necessary, because each board can be accessed machine-readable per se via adding <code>.JSON</code> to the board url. <strong>Prerequisite is that the board is set to PUBLIC</strong>. The URL is structured according to the following scheme:</p>\n<p><code>https://trello.com/b/&lt;WORKPLACE-ID&gt;/&lt;BOARD-NAME&gt;.json</code></p>\n<p>The URL accepts following parameters (as far as I found out), to filter out some not needed content:</p>\n<ul>\n<li><strong>fields</strong> (string)</li>\n<li><strong>lists</strong> (string)</li>\n<li><strong>list_fields</strong> (string)</li>\n<li><strong>cards</strong> (string)</li>\n<li><strong>card_fields</strong> (string)</li>\n<li><strong>card_attachments</strong> (bool)</li>\n<li><strong>card_attachment_fields</strong> (string)</li>\n<li><strong>customFields</strong> (bool)</li>\n<li><strong>card_customFieldItems</strong> (bool)</li>\n<li>members (bool)</li>\n<li>member_fields (string)</li>\n<li>organization (bool)</li>\n<li>checklists (string)</li>\n<li>checklist_fields (string)</li>\n<li>labels (string)</li>\n<li>actions (string)</li>\n<li>action_fields (string)</li>\n<li>actions_limit (number)</li>\n</ul>\n<p>All boolean parameters can assume <code>true</code> or <code>false</code> and the string parameters either <code>all</code>, <code>none</code> or (some) a comma-separated value list of fields to show. For example:</p>\n<p><code>https://trello.com/b/o2tmzJAw/test.json?fields=none&amp;lists=all&amp;list_fields=name&amp;cards=all&amp;card_fields=desc,idList,name</code></p>\n<p>… shows up like this:</p>\n<figure class=\"highlight json\"><figcaption><span>Trello JSON (shortened)</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a871b59e3b200022455381&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;cards&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span> ... <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8586e7de45d0fc54d0d39&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;desc&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Kate shows us how to create a tree view as collapsible list, created using only html and css, without the need for JavaScript&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;idList&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8585dc0c10c020ca9ea03&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Tree views in CSS&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span> ... <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;lists&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a997ab23684f02303a0525&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Discoveries INBOX&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8585dc0c10c020ca9ea03&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Discoveries: CSS&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>Important to now here is, that most of the data are NOT hierarchially structured, like Board &gt; List &gt; Cards, but in parallel. You have to pick the id of a list to filter the cards array by it. The same with custom fields inside a card: it holds a reference to the custom field list only.</p>\n<p>For the attachments of a card, Trello distinguishes between URL’s and files. The attribute <code>bytes</code> is null for URLs and the URL itself is in name. Files, on the other hand, have <code>bytes</code> greater than 0 and a specific <code>mimeType</code>, while images additionally have up to seven different <code>previews</code> in the widths 70, 150, 250, 300, 600 and original. Very handy for my case, since I always scale down my screenshots to 600 pixels.</p>\n<p><code>https://trello.com/b/o2tmzJAw/test.json?fields=none&amp;lists=all&amp;list_fields=name&amp;cards=all&amp;card_fields=desc,idList,name&amp;card_attachments=true&amp;card_attachment_fields=bytes,mimeType,name,previews&amp;customFields=true&amp;card_customFieldItems=true</code></p>\n<figure class=\"highlight json\"><figcaption><span>... card item in Trello JSON (shortened)</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8586e7de45d0fc54d0d39&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;desc&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Kate shows us how to create a tree view as collapsible list, created using only html and css, without the need for JavaScript&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;idList&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8585dc0c10c020ca9ea03&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Tree views in CSS&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;attachments&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;bytes&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">null</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;mimeType&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://iamkate.com/code/tree-views/&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;previews&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8586e7de45d0fc54d0d5b&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;bytes&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">225271</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;mimeType&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;image/png&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Screenshot_20221225-121537.png&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;previews&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">      <span class=\"punctuation\">&#123;</span> ... <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8586e7de45d0fc54d0d58&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8586e7de45d0fc54d0d58&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;scaled&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://trello.com/1/cards/63a8586e7de45d0fc54d0d39/attachments/63a8586e7de45d0fc54d0d52/previews/63a8586e7de45d0fc54d0d58/download/Screenshot_20221225-121537.png&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;bytes&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">111574</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;height&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">499</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;width&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">600</span></span><br><span class=\"line\">      <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"punctuation\">&#123;</span> ... <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;63a8586e7de45d0fc54d0d52&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"The-Generator\"><a href=\"#The-Generator\" class=\"headerlink\" title=\"The Generator\"></a>The Generator</h2><p>First of all: This generator has NOTHING to do with Hexo’s build-in <a href=\"https://hexo.io/api/generator.html\">generators</a>. It’s just a Node script, which produces MD files that later on will be processed by Hexo into posts!</p>\n<p>What should he do:</p>\n<ol>\n<li>Download Board JSON from Trello</li>\n<li>Iterate through <code>lists</code> to find the one to process</li>\n<li>Iterate through <code>cards</code> to find all referencing the chosen list</li>\n<li>Create new POST object to store all needed information</li>\n<li>Process all found cards…<ol>\n<li>Create new ITEM object to store all needed information</li>\n<li>Store TITLE, generated KEY out of TITLE, DESCRIPTION in ITEM</li>\n<li>Resolve AUTHOR from <code>customfields</code> for ITEM</li>\n<li>Iterate through card <code>attachments</code></li>\n<li>Store URL in ITEM, when its a link</li>\n<li>Generate IMAGENAME out of KEY and store in ITEM, when its an image</li>\n<li>Create new POST.FOLDER for the images</li>\n<li>Download image from attachment URL into POST.FOLDER as IMAGENAME</li>\n<li>Add ITEM to POST.ITEMS</li>\n</ol>\n</li>\n<li>Get photograph for new post (kiko.io special, see <a href=\"/post/Automatic-Header-Images-in-Hexo/\" title=\"Automatic Header Images in Hexo\">Automatic Header Images in Hexo</a>)<ol>\n<li>Store PHOTOGRAPH information in POST</li>\n</ol>\n</li>\n<li>Generate new post via Handlebars template</li>\n<li>Store new post</li>\n</ol>\n<p>The goal is that I only need to write an introduction and adjust a few frontmatter variables before generating and publishing the post.</p>\n<h3 id=\"Settings\"><a href=\"#Settings\" class=\"headerlink\" title=\"Settings\"></a>Settings</h3><p>First task is to save the possible settings in Hexo’s default configuration file:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Trello Discoveries Generator Script</span></span><br><span class=\"line\"><span class=\"attr\">discoveries:</span></span><br><span class=\"line\">  <span class=\"attr\">board:</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">https://trello.com/b/D6zIhLus/collections.json</span></span><br><span class=\"line\">    <span class=\"attr\">parameters:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">fields</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">name</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">lists</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">all</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">list_fields</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">name</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">cards</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">all</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">card_fields</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">closed,desc,idList,name</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">card_attachments</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">card_attachment_fields</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">bytes,mimeType,name,previews</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">customFields</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">card_customFieldItems</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">template:</span> <span class=\"string\">discoveries.handlebars</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Template\"><a href=\"#Template\" class=\"headerlink\" title=\"Template\"></a>Template</h3><p>Next step is creating a <a href=\"https://handlebarsjs.com/\">Handlebars</a> template out of my scaffold file I used so far:</p>\n<figure class=\"highlight hbs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"language-xml\">---</span></span><br><span class=\"line\"><span class=\"language-xml\">slug: </span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">key</span>&#125;&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">title: &#x27;</span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">title</span>&#125;&#125;&#125;</span><span class=\"language-xml\">&#x27;</span></span><br><span class=\"line\"><span class=\"language-xml\">subtitle:</span></span><br><span class=\"line\"><span class=\"language-xml\">date: </span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">date</span>&#125;&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">photograph:</span></span><br><span class=\"line\"><span class=\"language-xml\">  file: </span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">photograph.file</span>&#125;&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">  name: </span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">photograph.name</span>&#125;&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">  link: </span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">photograph.link</span>&#125;&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">  socialmedia: /static/images/social-media/</span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">key</span>&#125;&#125;&#125;</span><span class=\"language-xml\">.png</span></span><br><span class=\"line\"><span class=\"language-xml\">series: Discoveries</span></span><br><span class=\"line\"><span class=\"language-xml\">categories:</span></span><br><span class=\"line\"><span class=\"language-xml\">  - Misc</span></span><br><span class=\"line\"><span class=\"language-xml\">tags:</span></span><br><span class=\"line\"><span class=\"language-xml\">  - Collection</span></span><br><span class=\"line\"><span class=\"language-xml\">related:</span></span><br><span class=\"line\"><span class=\"language-xml\">  - Discoveries-xx</span></span><br><span class=\"line\"><span class=\"language-xml\">  - Discoveries-yy</span></span><br><span class=\"line\"><span class=\"language-xml\">  - Discoveries-zz</span></span><br><span class=\"line\"><span class=\"language-xml\">syndication:</span></span><br><span class=\"line\"><span class=\"language-xml\">  - host: Mastodon</span></span><br><span class=\"line\"><span class=\"language-xml\">    url: </span></span><br><span class=\"line\"><span class=\"language-xml\">---</span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">INTRODUCTION...</span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">&#123;% anchorlist </span></span><br><span class=\"line\"><span class=\"language-xml\"></span><span class=\"template-tag\">&#123;&#123;#<span class=\"name\"><span class=\"built_in\">each</span></span> items&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">  &quot;</span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">title</span>&#125;&#125;&#125;</span><span class=\"language-xml\">|</span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">key</span>&#125;&#125;&#125;</span><span class=\"language-xml\">&quot;</span></span><br><span class=\"line\"><span class=\"language-xml\"></span><span class=\"template-tag\">&#123;&#123;/<span class=\"name\"><span class=\"built_in\">each</span></span>&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">%&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"comment\">&lt;!-- more --&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\"></span><span class=\"template-tag\">&#123;&#123;#<span class=\"name\"><span class=\"built_in\">each</span></span> items&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">&#123;% discovery &quot;</span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">title</span>&#125;&#125;&#125;</span><span class=\"language-xml\">&quot; &quot;</span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">author</span>&#125;&#125;&#125;</span><span class=\"language-xml\">&quot; &quot;</span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">url</span>&#125;&#125;&#125;</span><span class=\"language-xml\">&quot; </span><span class=\"template-variable\">&#123;&#123;&#123;.<span class=\"name\">./key</span>&#125;&#125;&#125;</span><span class=\"language-xml\"> </span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">imageName</span>&#125;&#125;&#125;</span><span class=\"language-xml\"> %&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\"></span><span class=\"template-variable\">&#123;&#123;&#123;<span class=\"name\">description</span>&#125;&#125;&#125;</span><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">&#123;% enddiscovery %&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\"></span><span class=\"template-tag\">&#123;&#123;/<span class=\"name\"><span class=\"built_in\">each</span></span>&#125;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Generator-Script\"><a href=\"#Generator-Script\" class=\"headerlink\" title=\"Generator Script\"></a>Generator Script</h3><p>Next, the generator itself, which lives in <code>/lib/scripts/</code>. It is implemented as a class with CommonJS and takes two parameters in the constructor for defining the number of the Discoveries post to create and the name of the Trello list, where the data for this should come from. It’s main function is <code>generate</code>, which starts the generation. Here’s the skeleton:</p>\n<figure class=\"highlight js\"><figcaption><span>discoveries-generator.js</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;fs&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> yaml = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;js-yaml&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;path&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> axios = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;axios&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> handlebars = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;handlebars&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; marked &#125; = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;marked&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Generator</span> &#123; </span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">let</span> _config;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> _trelloUrl;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> _templateFile;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// Init new post object</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> _post = &#123;</span><br><span class=\"line\">    <span class=\"attr\">board</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">list</span>: <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">discoveryNo, listName</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Init the generator and gather all necessary data for running it</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">generate</span>(<span class=\"params\"></span>) &#123; </span><br><span class=\"line\">    <span class=\"comment\">// Run the generator</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">async</span> <span class=\"title function_\">downloadImage</span>(<span class=\"params\">url, item</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Helper for downloading the images asynchronously  </span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">createPostFromTemplate</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Helper for creating the post&#x27;s MD file out of the template</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>At this point I will refrain from reproducing the complete code here. Just follow this <a href=\"https://github.com/kristofzerbe/kiko.io/blob/cb9ba3f9157771231258834b156bb6aead2cd229/lib/discoveries-generator.cjs\">link</a> …</strong></p>\n<p>However, a few points in the implementation are important to consider:</p>\n<ol>\n<li><p>The downloads are performed by means of the promise based HTTP client <a href=\"https://axios-http.com/\">axios</a>. I can only recommend this thing…</p>\n</li>\n<li><p>The image downloads are initially collected in a Promise list for subsequent execution, while iterating through the cards of the selected Trello list</p>\n</li>\n</ol>\n<p>The script is actually really straight forward, but I have some improvements in mind, which will find their way into the code later on:</p>\n<p>A. If an image is missing, create a proper screenshot via Puppeteer</p>\n<p>B. Introduce a top most card(s) for the INTRODUCTION, a SUBTITLE and some additional TAGS, to avoid having to rework the new post before publishing</p>\n<p>C. Automated insertion of the RELATED posts, based on the last three Discoveries issues</p>\n<h3 id=\"Run-it-…\"><a href=\"#Run-it-…\" class=\"headerlink\" title=\"Run it …\"></a>Run it …</h3><p>The easiest way to get the generator running, is to create a simple runner script:</p>\n<figure class=\"highlight js\"><figcaption><span>_run_discoveries-generator.cjs</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">Generator</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./discoveries-generator.cjs&quot;</span>).<span class=\"property\">Generator</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> discoveryNo = process.<span class=\"property\">argv</span>[<span class=\"number\">2</span>].<span class=\"title function_\">toString</span>();</span><br><span class=\"line\"><span class=\"keyword\">const</span> listName = process.<span class=\"property\">argv</span>[<span class=\"number\">3</span>].<span class=\"title function_\">toString</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> generator = <span class=\"keyword\">new</span> <span class=\"title class_\">Generator</span>(discoveryNo, listName);</span><br><span class=\"line\">generator.<span class=\"title function_\">generate</span>();</span><br></pre></td></tr></table></figure>\n\n<p>The execution in the console then is just a one-liner:</p>\n<p><code>node &quot;./lib/_run_discoveries-generator.cjs&quot; &quot;&lt;NUMBER&gt;&quot; &quot;&lt;TRELLO-LISTNAME&gt;&quot;</code></p>\n<hr>\n<p>It was fun to write this automation during Christmas. Also kept me from stuffing too many cookies inside me ;)</p>\n","_path":"post/Generate-Content-from-Trello/","_link":"https://kiko.io/post/Generate-Content-from-Trello/","_id":"cllqc052o002lkjq06led7nqx"}}