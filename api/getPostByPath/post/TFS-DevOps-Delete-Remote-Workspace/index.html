{"type":"getPostByPath","data":{"title":"TFS/DevOps: Delete Remote Workspace","date":"2020-02-27T23:00:00.000Z","description":"<p>If you are working with freelance developers and Azure DevOps&#x2F;TFS with TFVC (Team Foundation Version Control) in your company, maybe this will look familiar to you: You hire a new freelancer and you want to reuse the hardware, including the complete software setup, to bring him&#x2F;her to work as fast and straightforward as possible. You set up a new Azure Devops account with all necessary permissions and you think you’re done. No you are not…</p>","categories":[{"name":"Tools","_id":"clp3xjcnj0042m3oz8ly312b9"}],"tags":[{"name":"Visual Studio","_id":"clp3xjcnw005dm3ozfu9pgekx"},{"name":"TFS/DevOps","_id":"clp3xjcom0080m3oz7yxsgkar"}],"content":"<p>If you are working with freelance developers and Azure DevOps&#x2F;TFS with TFVC (Team Foundation Version Control) in your company, maybe this will look familiar to you: You hire a new freelancer and you want to reuse the hardware, including the complete software setup, to bring him&#x2F;her to work as fast and straightforward as possible. You set up a new Azure Devops account with all necessary permissions and you think you’re done. No you are not…</p>\n<span id=\"more\"></span>\n\n<p>Everytime a user connects to a Team Project on Azure DevOps via Visual Studio and gets the code, VS is creating a <strong>remote workspace</strong> on the server, with the <strong>machine name</strong> as default, therefor it is not enough to wipe the profile and any other legacies of the last user from the machine. You also have to remove the remote workspace. Otherwise you will get an error message like that, if you are using a unique file structure on the developers hard disc:</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">The working folder c://xxx is already in use by the workspace yyy;zzz on computer yyy</span><br></pre></td></tr></table></figure>\n\n<p>The variable xxx stands for the blocked folder, yyy for the workspace&#x2F;machine name and zzz for the users id on Azure DevOps.</p>\n<p>Unfortunately, there is no visual management console on Azure DevOps to manage your server workspaces, but there is a command line tool called <strong><a href=\"https://docs.microsoft.com/en-us/azure/devops/repos/tfvc/use-team-foundation-version-control-commands?view=azure-devops\">tf.exe</a></strong>.</p>\n<p>The easiest way to get rid of the unused server workspace in 3 steps:</p>\n<h2 id=\"Step-1\"><a href=\"#Step-1\" class=\"headerlink\" title=\"Step 1\"></a>Step 1</h2><p>Run <strong>Developer Command Prompt</strong> with Administrator privileges from Visual Studio 2019 and login with your Azure DevOps credentials. If the Login dialog doesn’t show up, force it by executing:</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tf.exe workspace</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-2\"><a href=\"#Step-2\" class=\"headerlink\" title=\"Step 2\"></a>Step 2</h2><p>Get a list of all remote workspaces available in your DevOps Collection by running the command:</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tf.exe workspaces /computer:* /owner:* /format:xml &gt; c:\\temp\\workspaces.xml</span><br></pre></td></tr></table></figure>\n\n<p>You can get a list of all your workspaces by running <code>tf workspaces</code>, but the list only shows you the <code>owner</code>, but not the necessary <code>ownerid</code> and … it is nicer to have a file to search in.</p>\n<h2 id=\"Step-3\"><a href=\"#Step-3\" class=\"headerlink\" title=\"Step 3\"></a>Step 3</h2><p>Find the abandoned workspace in the list and note its <code>name</code> and  <code>ownerid</code> for running the command:</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tf workspace /delete &#123;WORKSPACE.name&#125;;&#123;WORKSPACE.ownerid&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Now your new colleague can create his own workspace on the same machine.</p>\n<h2 id=\"Update\"><a href=\"#Update\" class=\"headerlink\" title=\"Update\"></a>Update</h2><p>In case you want to switch your own DevOps account to another and use the same folder as before, you can certainly delete the local workspace, but this wont help, because you are still logged in at TeamExplorer and the folder knows to whom it belongs. Solution is easy:</p>\n<ol>\n<li>Quit Visual Studio</li>\n<li>Rename folder in <code>***_OLD</code> or something</li>\n<li>Create new folder with the same name</li>\n<li>Enter <code>C:\\Users\\YOUR-NAME\\appdata\\Local\\Microsoft\\Team Foundation\\VS-VERSION\\Cache</code> and emtpy the folder to let Visual Studio forget who you are</li>\n<li>Remove all your Remote Workspaces as described above</li>\n<li>Start Visual Studio, connect in TeamExplorer to your TFS server and map the code to your folder</li>\n</ol>\n<h2 id=\"More-Info\"><a href=\"#More-Info\" class=\"headerlink\" title=\"More Info\"></a>More Info</h2>\n        <ul class=\"moreinfo-list\">\n            <li>Microsoft Docs: <a href=\"https://docs.microsoft.com/en-us/azure/devops/repos/tfvc/use-team-foundation-version-control-commands?view=azure-devops\">Use Team Foundation version control commands</a></li><li>Stackoverflow: <a href=\"https://stackoverflow.com/questions/28298771/how-to-remove-tfs-workspace-mapping-for-another-user/28299407\">How to remove TFS workspace mapping for another user</a></li>\n        </ul>\n    \n","_path":"post/TFS-DevOps-Delete-Remote-Workspace/","_link":"https://kiko.io/post/TFS-DevOps-Delete-Remote-Workspace/","_id":"clp3xjcli0010m3ozexz11ktj"}}