{"type":"getPostById","data":{"title":"Automatic Duplicate Image Shadow","date":"2021-07-16T15:45:30.000Z","description":"<p>At the beginning of the year I wrote a <a href=\"/post/Use-a-duplicate-image-to-drop-a-shadow/\" title=\"Use a duplicate image to drop a shadow\">post</a> about showing a shadow on an image with the image itself instead of using <code>box-shadow</code>, to make the image appear glass-like.</p>\n<p><img src=\"/post/Automatic-Duplicate-Image-Shadow/image-shadow.jpg\" alt=\"Image Shadow\"></p>\n<p>Nice trick, but it would be much easier to have a little script, that does this automatically for all images on a page. In this post I will show you how to achieve this.</p>","categories":[{"name":"JavaScript","_id":"clizsija1003cjdoigkfsd3xz"}],"tags":[{"name":"CSS","_id":"clizsija9003xjdoih5rf50ly"},{"name":"Imaging","_id":"clizsijbp007ejdoihui5ed6y"},{"name":"DOM","_id":"clizsijbs007ojdoi5rl59s17"}],"content":"<p>At the beginning of the year I wrote a <a href=\"/post/Use-a-duplicate-image-to-drop-a-shadow/\" title=\"Use a duplicate image to drop a shadow\">post</a> about showing a shadow on an image with the image itself instead of using <code>box-shadow</code>, to make the image appear glass-like.</p>\n<p><img src=\"/post/Automatic-Duplicate-Image-Shadow/image-shadow.jpg\" alt=\"Image Shadow\"></p>\n<p>Nice trick, but it would be much easier to have a little script, that does this automatically for all images on a page. In this post I will show you how to achieve this.</p>\n<span id=\"more\"></span>\n\n<p>The script is not really rocket science: We just have to surround an image tag….</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;my-image.jpg&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>… with a wrapper, which holds the original image and a blurred duplicate of it:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;shadow-wrapper&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;drop-shadow&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;my-image.jpg&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;shadow&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;my-image.jpg&quot;</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>The rest will be done by CSS:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">div</span><span class=\"selector-class\">.shadow-wrapper</span> &#123; <span class=\"comment\">/* Wrapper */</span></span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">30px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">div</span><span class=\"selector-class\">.shadow-wrapper</span> <span class=\"selector-tag\">img</span><span class=\"selector-class\">.drop-shadow</span> &#123; <span class=\"comment\">/* Original image */</span></span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">z-index</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">float</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">div</span><span class=\"selector-class\">.shadow-wrapper</span> <span class=\"selector-tag\">img</span><span class=\"selector-class\">.shadow</span> &#123; <span class=\"comment\">/* Shadow image */</span> </span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">90%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">5%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">15%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">z-index</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">filter</span>: <span class=\"built_in\">blur</span>(<span class=\"number\">10px</span>);</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.8</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">float</span>: none;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>To make long story short: The wrapper is positioned <code>relative</code> and both images <code>absolute</code>. The shadow image is 10% smaller than the original, blurred by 10 pixels and lies beneath the original one, slightly shifted down by 15%.</p>\n<p>Very important is to give the wrapper a bottom margin, otherwise the shadow will be rendered to tight to other elements, what looks not good.</p>\n<h2 id=\"The-Script\"><a href=\"#The-Script\" class=\"headerlink\" title=\"The Script\"></a>The Script</h2><p>What the script should do:</p>\n<ul>\n<li>Take any image tag with a particular class name (here <code>drop-shadow</code>)</li>\n<li>Create a new wrapper with all classes the image tag has</li>\n<li>Size the wrapper as the image</li>\n<li>Place the image tag inside the wrapper</li>\n<li>Clone the image tag and append it to the wrapper also</li>\n<li>Replace the image tag with the new wrapper HTML</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelectorAll</span>(<span class=\"string\">&quot;img.drop-shadow&quot;</span>).<span class=\"title function_\">forEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\">item</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">let</span> wrapper = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;div&quot;</span>);</span><br><span class=\"line\">  wrapper.<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(<span class=\"string\">&quot;shadow-wrapper&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  item.<span class=\"property\">classList</span>.<span class=\"title function_\">forEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\">c</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (c != <span class=\"string\">&quot;drop-shadow&quot;</span>) wrapper.<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(c);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  wrapper.<span class=\"property\">style</span>.<span class=\"property\">width</span> = item.<span class=\"property\">clientWidth</span> + <span class=\"string\">&quot;px&quot;</span>;</span><br><span class=\"line\">  wrapper.<span class=\"property\">style</span>.<span class=\"property\">height</span> = item.<span class=\"property\">clientHeight</span> + <span class=\"string\">&quot;px&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  wrapper.<span class=\"title function_\">insertAdjacentHTML</span>(<span class=\"string\">&quot;beforeend&quot;</span>, item.<span class=\"property\">outerHTML</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">let</span> shadow = item.<span class=\"title function_\">cloneNode</span>();</span><br><span class=\"line\">  shadow.<span class=\"property\">classList</span>.<span class=\"title function_\">remove</span>(<span class=\"string\">&quot;drop-shadow&quot;</span>);</span><br><span class=\"line\">  shadow.<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(<span class=\"string\">&quot;shadow&quot;</span>);</span><br><span class=\"line\">  wrapper.<span class=\"title function_\">insertAdjacentHTML</span>(<span class=\"string\">&quot;beforeend&quot;</span>, shadow.<span class=\"property\">outerHTML</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  item.<span class=\"property\">outerHTML</span> = wrapper.<span class=\"property\">outerHTML</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>The result in comparison with no shadow and the default <code>box-shadow</code>:</p>\n\n    <iframe class=\"indiepen\"\n        src=\"https://indiepen.tech/embed/?url=https%3A%2F%2Fkiko.io%2Fpost%2FAutomatic-Duplicate-Image-Shadow%2Fsample&tab=result\"\n        style=\"width: 100%; overflow: hidden; display: block; border: 0;\"\n        title=\"Indiepen Embed\"\n        loading=\"lazy\" \n        width=\"100%\" \n        height=\"600\">\n    </iframe>\n  \n\n<p>Happy shadowing…</p>\n","_path":"post/Automatic-Duplicate-Image-Shadow/","_link":"https://kiko.io/post/Automatic-Duplicate-Image-Shadow/","_id":"clizsij750012jdoi1wi1ac4h"}}