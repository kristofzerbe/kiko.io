{"type":"getPostById","data":{"title":"Pimping the Permalink","date":"2020-09-20T14:30:37.000Z","description":"<p>Until now I did not show the permalink under my posts in this blog, but in the past I had sometimes the need to pass one of the links and it was not very user-friendly, on desktop as well as on mobile. Not the One-Click experience I prefer.</p>\n<p>My goal was to show the permalink and, even more important, provide a simple way to copy and to share. JavaScript to the rescue…</p>","categories":[{"name":"JavaScript","_id":"clp039lh20048msqc96uehxt5"}],"tags":[{"name":"Hexo","_id":"clp039lgz003xmsqc4h7n3f7c"},{"name":"CSS","_id":"clp039lgz003zmsqc5e8o3qi6"},{"name":"Stylus","_id":"clp039lh9004zmsqcfv4j10xn"},{"name":"Share","_id":"clp039li0007tmsqc6oaedqkp"}],"content":"<p>Until now I did not show the permalink under my posts in this blog, but in the past I had sometimes the need to pass one of the links and it was not very user-friendly, on desktop as well as on mobile. Not the One-Click experience I prefer.</p>\n<p>My goal was to show the permalink and, even more important, provide a simple way to copy and to share. JavaScript to the rescue…</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Display\"><a href=\"#Display\" class=\"headerlink\" title=\"Display\"></a>Display</h2><p>As I run my blog with <a href=\"https://hexo.io/\">Hexo</a>, I deal with <code>EJS</code> files. To show the permalink in my <code>article.ejs</code>, was quite simple. First step was to create a new partial file named <code>permalink.ejs</code>, to be called every time when the complete article has to be rendered:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;% <span class=\"keyword\">if</span> (!index)&#123; %&gt;</span><br><span class=\"line\">  &lt;%- <span class=\"title function_\">partial</span>(<span class=\"string\">&#x27;post/permalink&#x27;</span>, &#123; <span class=\"attr\">class_name</span>: <span class=\"string\">&#x27;article-permalink&#x27;</span> &#125;) %&gt;</span><br><span class=\"line\">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>\n\n<p>The partial file looked like this in this step:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;&lt;%= class_name %&gt;&quot;</span>&quot;&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;article-permalink&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;&lt;%- post.permalink %&gt;&quot;</span>&gt;</span>&lt;%- post.permalink %&gt;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Copy\"><a href=\"#Copy\" class=\"headerlink\" title=\"Copy\"></a>Copy</h2><p>As I read a little bit about the possibilities to copy text into the clipboard via JavaScript on <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">MDN</a>, it became obvious that a link is not the best solution, because using the <code>exeCommand</code> needs to have something selected and this is difficult on anchors. Then … do it with an input:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;&lt;%= class_name %&gt;&quot;</span>&quot;&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;article-permalink&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%- post.permalink %&gt;&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;action-copy&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-action&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;javascript:copyPermalink();&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">var</span> copyText = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&quot;#article-permalink&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">  </span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"comment\">//Disable Input by default</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">  copyText.<span class=\"property\">disabled</span> = <span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">function</span> <span class=\"title function_\">copyPermalink</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Enable Input</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    copyText.<span class=\"property\">disabled</span> = <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Select permalink text</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    copyText.<span class=\"title function_\">select</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Copy to clipboard</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">document</span>.<span class=\"title function_\">execCommand</span>(<span class=\"string\">&quot;copy&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Remove selection again</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    copyText.<span class=\"title function_\">blur</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Disable Input again</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    copyText.<span class=\"property\">disabled</span> = <span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>Nice, but a user feedback, that the text has been copied to the clipboard, was advisable, because nothing is more annoying, when you click somewhere and nothing seems to happen. As I hate default browser confirmations and other distracting messaging methods, I wanted to use the input itself, by fading out the link text, replace it with a message and fade in the text again:</p>\n<p><img src=\"/post/Pimping-the-Permalink/copy-animation.gif\" alt=\"Copy Animation\"></p>\n<p>I extended my <code>animation.styl</code> (Hexo works with <a href=\"https://stylus-lang.com/\">Stylus</a>) with two keyframe animations … one for fading in, one for fading out…</p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadeIn &#123;</span><br><span class=\"line\">  <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>:<span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>:<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.fade-in-500</span></span><br><span class=\"line\">  <span class=\"attribute\">animation</span>: fadeIn ease <span class=\"number\">0.5s</span>;</span><br><span class=\"line\"><span class=\"selector-class\">.fade-in-1000</span></span><br><span class=\"line\">  <span class=\"attribute\">animation</span>: fadeIn ease <span class=\"number\">1s</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadeOut &#123;</span><br><span class=\"line\">  <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>:<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>:<span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.fade-out-500</span></span><br><span class=\"line\">  <span class=\"attribute\">animation</span>: fadeOut ease <span class=\"number\">0.5s</span>;</span><br><span class=\"line\"><span class=\"selector-class\">.fade-out-1000</span></span><br><span class=\"line\">  <span class=\"attribute\">animation</span>: fadeOut ease <span class=\"number\">1s</span>;</span><br></pre></td></tr></table></figure>\n\n<p>… and wrote a setTimeout cascade to achive the effect:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;&lt;%= class_name %&gt;&quot;</span>&quot;&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;article-permalink&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%- post.permalink %&gt;&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-action action-copy&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;javascript:copyPermalink();&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">var</span> copyText = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&quot;#article-permalink&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">  copyText.<span class=\"property\">disabled</span> = <span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">function</span> <span class=\"title function_\">copyPermalink</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      copyText.<span class=\"property\">disabled</span> = <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      copyText.<span class=\"title function_\">select</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">document</span>.<span class=\"title function_\">execCommand</span>(<span class=\"string\">&quot;copy&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">      copyText.<span class=\"title function_\">blur</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">      copyText.<span class=\"property\">disabled</span> = <span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Store original text</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">var</span> permalink = copyText.<span class=\"property\">value</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Start fading out</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    copyText.<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(<span class=\"string\">&quot;fade-out-500&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">//Wait until animation is done</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"comment\">//Set message, remove fadout class and add start fading in</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        copyText.<span class=\"property\">value</span> = <span class=\"string\">&quot;copied to clipboard&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        copyText.<span class=\"property\">classList</span>.<span class=\"title function_\">remove</span>(<span class=\"string\">&quot;fade-out-500&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        copyText.<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(<span class=\"string\">&quot;fade-in-1000&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"comment\">//Wait 2 seconds to show the message</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"comment\">//Start to fade out message</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            copyText.<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(<span class=\"string\">&quot;fade-out-500&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"comment\">//Wait until animation is done</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">//Set original text again and remove fadout class</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                copyText.<span class=\"property\">value</span> = permalink;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                copyText.<span class=\"property\">classList</span>.<span class=\"title function_\">remove</span>(<span class=\"string\">&quot;fade-out-500&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">//Wait until animation is done</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">//Remove fadeout class</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    copyText.<span class=\"property\">classList</span>.<span class=\"title function_\">remove</span>(<span class=\"string\">&quot;fade-in-1000&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                &#125;, <span class=\"number\">500</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;, <span class=\"number\">500</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;, <span class=\"number\">2000</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;, <span class=\"number\">500</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Share\"><a href=\"#Share\" class=\"headerlink\" title=\"Share\"></a>Share</h2><p>The second permalink feature was a little bit trickier, because I didn’t want to use one of the sharing libraries out there, whose business model is based on my readers data (always keep conservative on implementing third party stuff, because you never know what they are doing with the data). But a couple of months ago I read about a new native browser API for WebApps on the rise: <strong>Web Share API</strong>.</p>\n<p>Since 2019 <a href=\"https://www.w3.org/\">W3C</a> is working on this API, <em>for sharing text, links and other content to an arbitrary destination of the user’s choice</em>. On 27 August 2020 the published a <a href=\"https://www.w3.org/TR/web-share/\">Working Draft</a> and on 16 September 2020 the latest <a href=\"https://w3c.github.io/web-share/\">Editors Draft</a>.</p>\n<p><img src=\"/post/Pimping-the-Permalink/caniuse-web-share.png\" alt=\"Can I Use - Web Share, state today\"></p>\n<p>Brand new stuff. The browser support is not the best yet, but it will be getting better in the near feature, especially as Edge Chrome is one of the early adopters.</p>\n<p><img src=\"/post/Pimping-the-Permalink/web-share-edge-chrome.png\" alt=\"Web Share in Edge Chrome\"></p>\n<p><a href=\"https://web.dev/web-share/\">web.dev</a> lists important requirements on using this new feature in JavaScript:</p>\n<ul>\n<li>It can only be used on a site that supports HTTPS</li>\n<li>It must be invoked in response to a user action such as a click</li>\n</ul>\n<p>But it can share URL’s, text and even files! </p>\n<p>A raw implementation can be:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (navigator.<span class=\"property\">share</span> === <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">  navigator.<span class=\"title function_\">share</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">title</span>: <span class=\"string\">&#x27;My Post&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">url</span>: <span class=\"string\">&#x27;https://my-domain.com/my-url&#x27;</span>,</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .<span class=\"title function_\">then</span>(<span class=\"function\">() =&gt;</span> <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Successful share&#x27;</span>))</span><br><span class=\"line\">  .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">error</span>) =&gt;</span> <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Error sharing&#x27;</span>, error));</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// fallback</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>I refrain to implement a fallback, rather I would like to show the appropriate button only to those users, whose browser supports it:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;&lt;%= class_name %&gt;&quot;</span>&quot;&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;article-permalink&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&lt;%- post.permalink %&gt;&quot;</span> <span class=\"attr\">data-id</span>=<span class=\"string\">&quot;&lt;%= post._id %&gt;&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;action-copy&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-action&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;javascript:copyPermalink();&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;action-share&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-action&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;javascript:sharePermalink();&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">copyPermalink</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      -- <span class=\"variable constant_\">SEE</span> <span class=\"variable constant_\">ABOVE</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">if</span> (navigator.<span class=\"property\">share</span> === <span class=\"literal\">undefined</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">var</span> shareLink = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&quot;#action-share&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        shareLink.<span class=\"property\">style</span>.<span class=\"property\">display</span> = <span class=\"string\">&quot;none&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">sharePermalink</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        navigator.<span class=\"title function_\">share</span>(&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">title</span>: <span class=\"string\">&quot;&lt;%- post.title %&gt;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">url</span>: <span class=\"string\">&quot;&lt;%- post.permalink %&gt;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"More-Info\"><a href=\"#More-Info\" class=\"headerlink\" title=\"More Info\"></a>More Info</h2>\n        <ul class=\"moreinfo-list\">\n            <li>w3c.github.io: <a href=\"https://w3c.github.io/web-share/demos/share-files.html\">W3C Web Share Test</a></li><li>heise Developer: <a href=\"https://www.heise.de/developer/artikel/Features-von-uebermorgen-Die-Web-Share-API-und-die-Web-Share-Target-API-3506197.html\">Features von übermorgen: Die Web Share API und die Web Share Target API (German)</a></li><li>CSS-Tricks: <a href=\"https://css-tricks.com/how-to-use-the-web-share-api/\">How to Use the Web Share API</a></li>\n        </ul>\n    \n","_path":"post/Pimping-the-Permalink/","_link":"https://kiko.io/post/Pimping-the-Permalink/","_id":"clp039leu000ymsqc8wjtfw23"}}